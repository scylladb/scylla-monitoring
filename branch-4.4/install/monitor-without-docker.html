

<!DOCTYPE html>
<html class="no-js" lang="en" style="visibility: hidden;">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Deploying Scylla Monitoring Stack Without Docker | ScyllaDB Docs 
        </title>
        <meta name="description" content="Scylla Monitoring Stack is a full stack for Scylla monitoring and alerting. The stack contains open source tools including Prometheus and Grafana, as well as custom Scylla dashboards and tooling." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://monitoring.docs.scylladb.com/stable/install/monitor-without-docker.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                  href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>

        
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.css">
            <script type="module" src="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.esm.js"></script>
        

        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css?v=0ebb4bd5" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
            
        
    
        
        
            
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script src="../_static/documentation_options.js?v=5929fcd5"></script>
            
        
            
                <script src="../_static/doctools.js?v=9a2dae69"></script>
            
        
            
                <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
            
        
            
                <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
            
        
            
                <script src="../_static/copybutton.js?v=f281be69"></script>
            
        
    
            
                <!-- Local meta tags -->
            
            
                <!-- Google Tag Manager docs -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-54NWVS4");
</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager global -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
            
        
    </head>

    <body class="brand-product">
        <section class="promo-banner  promo-banner--hide" style="display: none;">
    <div class="promo-banner-wrapper">
        <div class="promo-banner__content">
            
            <div class="promo-banner__title">ScyllaDB University Live | Free Virtual Training Event</div>
            <a class="promo-banner__button button button--reverse" href="#"
               target="_blank" rel="noopener noreferrer">Learn more</a>
        </div>
        <button class="promo-banner__close">
            <i class="icon-cancel"></i>
        </button>
    </div>
</section>
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/scylladb-logo-horizontal.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Deployments <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="icon-docs-cloud"></i>Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/manual/">
                            <i class="icon-server"></i>Server</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="icon-docs-manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="icon-docs-monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="icon-docs-operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/stable/drivers/cql-drivers">
                            <i class="icon-docs-nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/stable/drivers/dynamo-drivers">
                            <i class="icon-docs-alternator"></i>DynamoDB Drivers
                        </a>

                        <li>
                            <a href="https://docs.scylladb.com/stable/versioning/driver-support">
                                <i class="icon-docs-blog"></i>Supported Driver Versions
                            </a>
                        </li>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Resources
                    <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://university.scylladb.com">
                            <i class="icon-university"></i>
                            ScyllaDB University
                        </a>
                    </li>
                    <li>
                        <a href="https://forum.scylladb.com">
                            <i class="icon-docs-community"></i>
                            Community Forum
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html">
                            <i class="icon-docs-training"></i>
                            Tutorials
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://docs.scylladb.com/manual/stable/getting-started/installation-common/scylla-web-installer.html" class="button"><i class="icon-download me-2"></i> Install</a>
        </div>
    </div>
    <div class="header-search-box">
        <i class="dark-theme-toggler icon-theme"></i>
        <div class="search-box">
            <ci-search></ci-search>
        </div>
        
            <biel-button class="header-ask-ai" project="ddfdo8m94k"
                         header-title="ScyllaDB chatbot (beta)"
                         button-position="default"
                         modal-position="bottom-right"
                         button-style="dark">
                Ask AI
            </biel-button>
        
    </div>
    <div class="side-nav-toggle">
    <i class="dark-theme-toggler icon-theme"></i>
    <div class="side-nav-toggle__button" data-toggle="side-nav">
        <i class="icon-menu"></i>
    </div>
</div>
</header>
        <div class="title"></div>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
           class="bread__highlight">
            <i class="icon-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="../index.html"
           class="bread__highlight">
            ScyllaDB Monitoring
        </a>
    </span>
    
        <span class="bread__item">
            <a href="index.html" class="bread__highlight">
                Download and Install Scylla Monitoring Stack
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Deploying Scylla Monitoring Stack Without Docker</span>
</div>
                    </div>
                
                
                    <div class="sidebar-right-layout">
                        <div class="body-container">
                

                <div class="content-body">
                    
                        
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for a previous version of ScyllaDB Monitoring.
            
            <a href="../../stable/install/monitor-without-docker.html">Switch to the latest stable version.</a>
        </p>
    </div>

                    

                    <section id="deploying-scylla-monitoring-stack-without-docker">
<h1>Deploying Scylla Monitoring Stack Without Docker<a class="headerlink" href="#deploying-scylla-monitoring-stack-without-docker" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The following instructions will help to deploy <a class="reference external" href="monitoring_stack">Scylla Monitoring Stack</a> in cases where you can not use the recommended Docker version.</p>
<p>Please note, Scylla recommends you use the Docker version as it will provide you with most updated, current Scylla Monitoring system.</p>
<p>Scylla Monitoring uses the following components:</p>
<ul class="simple">
<li><p>Alertmanager</p></li>
<li><p>Grafana Loki</p></li>
<li><p>Prometheus</p></li>
<li><p>Grafana</p></li>
</ul>
<p>The common scenario for users who use their own standalone installation, is that they already have such a server and would like to consolidate.
We assume that that you already have Prometheus and Grafana running but we will add minimal installation instruction for all componenents.</p>
<p>We suggest that you follow the installation instruction of each of those products from their official documentation. It is also recommended that all servers will run as a service.</p>
</section>
<section id="minimal-production-system-recommendations">
<h2>Minimal Production System Recommendations<a class="headerlink" href="#minimal-production-system-recommendations" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>CPU</strong> - at least 2 physical cores/ 4vCPUs</p></li>
<li><p><strong>Memory</strong> - 15GB+ DRAM and proportional to the number of cores.</p></li>
<li><p><strong>Disk</strong> - persistent disk storage is proportional to the number of cores and Prometheus retention period (see the following section)</p></li>
<li><p><strong>Network</strong> - 1GbE/10GbE preferred</p></li>
</ul>
<section id="calculating-prometheus-minimal-disk-space-requirement">
<h3>Calculating Prometheus Minimal Disk Space requirement<a class="headerlink" href="#calculating-prometheus-minimal-disk-space-requirement" title="Link to this heading">¶</a></h3>
<p>Prometheus storage disk performance requirements: persistent block volume, for example an EC2 EBS volume</p>
<p>Prometheus storage disk volume requirement:  proportional to the number of metrics it holds. The default retention period is 15 days, and the disk requirement is around 12MB per core per day, assuming the default scraping interval of 20s.</p>
<p>For example, when monitoring a 6 node Scylla cluster, each with 16 CPU cores (so a total of 96 cores), and using the default 15 days retention time, you will need <strong>minimal</strong> disk space for prometheus of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">15</span> <span class="o">*</span> <span class="mi">12</span><span class="n">MB</span> <span class="o">~</span> <span class="mi">16</span><span class="n">GB</span>
</pre></div>
</div>
<p>To account for unexpected events, like replacing or adding nodes, we recommend allocating at least x2-3 space, in this case, ~50GB.
Prometheus Storage disk does not have to be as fast as Scylla disk, and EC2 EBS, for example, is fast enough and provides HA out of the box.</p>
</section>
<section id="calculating-prometheus-minimal-memory-space-requirement">
<h3>Calculating Prometheus Minimal Memory Space requirement<a class="headerlink" href="#calculating-prometheus-minimal-memory-space-requirement" title="Link to this heading">¶</a></h3>
<p>Prometheus uses more memory when querying over a longer duration (e.g. looking at a dashboard on a week view would take more memory than on an hourly duration).</p>
<p>For Prometheus alone, you should have 60MB of memory per core in the cluster and it would use about 600MB of virtual memory per core.
Because Prometheus is so memory demanding, it is a good idea to add swap, so queries with a longer duration would not crash the server.</p>
<script>
    function myFunction() {
        const hosts = parseInt(document.getElementById('hosts').value);
        const shards = parseInt(document.getElementById('shards').value);
        const retention = parseInt(document.getElementById('retention').value);
        let memory= (hosts*shards*60);
        let disk = (hosts*shards*retention*12);

        if (!Number.isNaN(disk)) {
            disk = (disk > 1024)?((disk/1024).toFixed(2) + "GB") : disk.toString() + "MB";
        } else {
           disk = "0";
        }
        document.getElementById('disk').textContent = disk;
        if (!Number.isNaN(memory)) {
            memory = (memory > 1024)?((memory/1024).toFixed(2) + "GB") : memory.toString() + "MB";
        } else {
            memory = "0";
        }
        document.getElementById('memory').textContent = memory;
    }
</script>
<div>
<table>
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%;text-align: center;">
<col style="width: 20%;text-align: center;">
</colgroup>
<tr><th># ScyllaDB Nodes</th><th># Cores Per ScyllaDB Node</th><th>Prometheus Retention in Days</th><th>Prometheus RAM</th><th>Prometheus Storage</th></tr>
<tr><td><input type="number" id="hosts" onchange="myFunction()" value="3" placeholder="# Nodes" min="1"></td><td><input type="number" id="shards" onchange="myFunction()" value="16" placeholder="# Cores" min="1"></td><td><input type="number" id="retention" placeholder="# Days" onchange="myFunction()" value="15" min="1"></td><td style="text-align:center"><span id="memory" style="text-align:center">0</span></td><td style="text-align: center"><span id="disk">0</span></td></tr>

</table>

</div>
<script>
myFunction();
</script><p>The main item to set an alert on is the available disk space in the monitoring system. Data is indefinitely accrued on the Prometheus data directory.
The current monitoring solution does not churn data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Confirm before installing, that your Grafana and Prometheus versions are supported by the Scylla Monitoring Stack version you want to install. Scylla-Monitoring follows the latest Prometheus and Grafana releases tightly. See the <a class="reference external" href="/install/monitoring_stack/#prerequisites">Scylla Monitoring Stack Compatibility Matrix</a>.</p>
</div>
</section>
</section>
<section id="install-scylla-monitoring-stack">
<h2>Install Scylla Monitoring Stack<a class="headerlink" href="#install-scylla-monitoring-stack" title="Link to this heading">¶</a></h2>
<p>The following procedure uses a <code class="docutils literal notranslate"><span class="pre">CentOS</span> <span class="pre">7</span></code> based instance</p>
<ol class="arabic simple">
<li><p>Download the latest Scylla Monitoring Stack release.</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/scylladb/scylla-monitoring/archive/refs/tags/scylla-monitoring-4.4.5.tar.gz
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Open the tar</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">tar</span> <span class="pre">-xvf</span> <span class="pre">scylla-monitoring-*.tar.gz</span></code></p>
</section>
<section id="install-alertmanager">
<h2>Install Alertmanager<a class="headerlink" href="#install-alertmanager" title="Link to this heading">¶</a></h2>
<p>Tested with alertmanager 0.22.2 version</p>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://prometheus.io/download/">alertmanager</a></p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/prometheus/alertmanager/releases/download/v0.22.2/alertmanager-0.22.2.linux-amd64.tar.gz
tar<span class="w"> </span>-xvf<span class="w"> </span>alertmanager-*.linux-amd64.tar.gz
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Copy the following file: <code class="docutils literal notranslate"><span class="pre">rule_config.yml</span></code> from <code class="docutils literal notranslate"><span class="pre">prometheus/</span></code> directory to <code class="docutils literal notranslate"><span class="pre">alertmanager.yml</span></code> in the alertmanager installation directory.</p></li>
</ol>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-p<span class="w"> </span>/home/centos/scylla-monitoring-scylla-monitoring-4.4.5/prometheus/rule_config.yml<span class="w"> </span>alertmanager-0.22.2.linux-amd64/alertmanager.yml
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Start the Alertmanager</p></li>
</ol>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>alertmanager-0.22.2.linux-amd64
./alertmanager
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Verify that Alertmanager is up and running, point your browser to the Alertmanager IP:Port</p></li>
</ol>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>http://192.168.135.166:9093/
</pre></div>
</div>
<img alt="../_images/alertmanager.png" src="../_images/alertmanager.png" />
</section>
<section id="install-grafana-loki">
<h2>Install Grafana Loki<a class="headerlink" href="#install-grafana-loki" title="Link to this heading">¶</a></h2>
<p>Loki is a log aggregation system inspired by Prometheus. Scylla Monitoring uses Loki for alerts and metrics generation. It does not replaces your centralized logging server, but it can, check
Loki-Grafana <a class="reference external" href="https://grafana.com/docs/loki/latest/">documentation</a> if you want to use it for centralized log collection.</p>
<p>We recomand using Loki with containers, but you can install it locally as described in <a class="reference external" href="https://grafana.com/docs/loki/latest/installation/local/">Loki installation</a></p>
<p>You will need to run both Loki and Promtail. Loki responsible for log parsing and acts as a Grafana and Proemtheus data-source and Generate alerts that are sent to the Alertmanager.</p>
<p>Promtail load logs into Loki, there are multiple ways of doing that, we suggest to use of rsyslog, this way you can add Promtail (and Loki) as a second log collection server.</p>
<p><strong>Loki Related files</strong></p>
<p>Loki has a configuration file and a rule file. You need to copy and modify the configuration.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/loki/rules
mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/loki/config
cp<span class="w"> </span>loki/rules/*<span class="w"> </span>/etc/loki/rules
cp<span class="w"> </span>loki/conf/loki-config.template.yaml<span class="w"> </span>/etc/loki/config/loki-config.yaml
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">/etc/loki/config/loki-config.yaml</span></code> and replace <code class="docutils literal notranslate"><span class="pre">ALERTMANAGER</span></code> with the alertmanager ip:port (i.e. localhost:9093)</p>
<p><strong>Promtail Related files</strong></p>
<p>Promtail has a configuration file. You need to copy and modify the configuration.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/promtail/
loki/promtail/promtail_config.template.yml<span class="w"> </span>/etc/promtail/config.yml
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">/etc/promtail/config.yml</span></code> and replace <code class="docutils literal notranslate"><span class="pre">LOKI_IP</span></code> with Loki’s ip:port (i.e. localhost:3100)</p>
</section>
<section id="install-prometheus">
<h2>Install Prometheus<a class="headerlink" href="#install-prometheus" title="Link to this heading">¶</a></h2>
<p>Tested with Prometheus version 2.27.1</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you already have a prometheus server, beside the expected scrap jobs, make sure you take the Prometheus rules directory.
The files not only contains important alerts, they are containing recording rules, without it different asspects of the dashboards will not work.</p>
</div>
<ol class="arabic simple">
<li><p>Install <a class="reference external" href="https://prometheus.io/download/">Prometheus</a></p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/prometheus/prometheus/releases/download/v2.27.1/prometheus-2.27.1.linux-amd64.tar.gz
tar<span class="w"> </span>-xvf<span class="w"> </span>prometheus-*.linux-amd64.tar.gz
</pre></div>
</div>
<p>2. Create Data and Config directories
.. code-block:: shell</p>
<blockquote>
<div><p>mkdir -p /prometheus/data
mkdir -p /etc/prometheus/prom_rules/
mkdir -p /etc/scylla.d/prometheus/</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Copy the following files: <code class="docutils literal notranslate"><span class="pre">scylla_servers.yml</span></code>, <code class="docutils literal notranslate"><span class="pre">prometheus.rules.yml</span></code> from <code class="docutils literal notranslate"><span class="pre">prometheus/</span></code> directory to Prometheus installation directory.</p></li>
</ol>
<p>Copy <code class="docutils literal notranslate"><span class="pre">prometheus/prometheus.yml.template</span></code> to <code class="docutils literal notranslate"><span class="pre">prometheus.yml</span></code></p>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>scylla-monitoring-scylla-monitoring-4.4.5/prometheus/prom_rules/*.yml<span class="w"> </span>/etc/prometheus/prom_rules/
cp<span class="w"> </span>scylla-monitoring-scylla-monitoring-4.4.5/prometheus/prometheus.yml.template<span class="w"> </span>/etc/prometheus/prometheus.yml
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Edit the <code class="docutils literal notranslate"><span class="pre">prometheus.yml</span></code> file to point to the correct static data sources.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to include the <code class="docutils literal notranslate"><span class="pre">honor_labels:</span> <span class="pre">false</span></code> parameter in the prometheus.yml file.</p>
</div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>vi<span class="w"> </span>/etc/prometheus/prometheus.yml
</pre></div>
</div>
<p>Set the alertmanger address and port by replacing <code class="docutils literal notranslate"><span class="pre">AM_ADDRESS</span></code> in the file.</p>
<p>For example if the alertmanager will run on the same host:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>alerting:
<span class="w">   </span>alertmanagers:
<span class="w">   </span>-<span class="w"> </span>static_configs:
<span class="w">       </span>-<span class="w"> </span>targets:
<span class="w">           </span>-<span class="w"> </span><span class="m">127</span>.0.0.1:9093
</pre></div>
</div>
<p>Replace the <cite>files</cite> in to point to the right local file, typically for <cite>scylla</cite>, <cite>node_exporter</cite> and <cite>manager_agent</cite> you can use the same file (<cite>scylla_servers.yml</cite>).</p>
<p>For example the scrape config for Scylla:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>global:
<span class="w">  </span>scrape_interval:<span class="w"> </span>5s<span class="w"> </span><span class="c1"># By default, scrape targets every 5 second.</span>
<span class="w">  </span>scrape_timeout:<span class="w"> </span>4s<span class="w"> </span><span class="c1"># Timeout before trying to scape a target again</span>

<span class="w">  </span><span class="c1"># Attach these labels to any time series or alerts when communicating with</span>
<span class="w">  </span><span class="c1"># external systems (federation, remote storage, Alertmanager).</span>
<span class="w">  </span>external_labels:
<span class="w">    </span>monitor:<span class="w"> </span><span class="s1">&#39;scylla-monitor&#39;</span>

scrape_configs:
-<span class="w"> </span>job_name:<span class="w"> </span>scylla
<span class="w">  </span>honor_labels:<span class="w"> </span><span class="nb">false</span>
<span class="w">  </span>file_sd_configs:
<span class="w">    </span>-<span class="w"> </span>files:
<span class="w">      </span>-<span class="w"> </span>/etc/scylla.d/prometheus/scylla_servers.yml
<span class="w">  </span>relabel_configs:
<span class="w">    </span>-<span class="w"> </span>source_labels:<span class="w"> </span><span class="o">[</span>__address__<span class="o">]</span>
<span class="w">      </span>regex:<span class="w">  </span><span class="s1">&#39;([^:]+)&#39;</span>
<span class="w">      </span>target_label:<span class="w"> </span>__address__
<span class="w">      </span>replacement:<span class="w"> </span><span class="s1">&#39;${1}:9180&#39;</span>

<span class="w">    </span>-<span class="w"> </span>source_labels:<span class="w"> </span><span class="o">[</span>__address__<span class="o">]</span>
<span class="w">      </span>regex:<span class="w">  </span><span class="s1">&#39;(.*):.+&#39;</span>
<span class="w">      </span>target_label:<span class="w"> </span>instance
<span class="w">      </span>replacement:<span class="w"> </span><span class="s1">&#39;${1}&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Create and set <code class="docutils literal notranslate"><span class="pre">scylla_servers.yml</span></code> file point to your Scylla nodes and <code class="docutils literal notranslate"><span class="pre">scylla_manager_server.yml</span></code> file to point to your Scylla Manager.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is no need to configure <code class="docutils literal notranslate"><span class="pre">node_exporter_server</span></code>. Instead, in the Prometheus scrape config of the node_exporter
you can use the same file you used for Scylla and Prometheus will assume you have a <code class="docutils literal notranslate"><span class="pre">node_exporter</span></code> running on each Scylla server.</p>
</div>
<p>An example for those files can be found under the Prometheus directory: <code class="docutils literal notranslate"><span class="pre">prometheus/scylla_servers.example.yml</span></code> and <code class="docutils literal notranslate"><span class="pre">prometheus/scylla_manager_servers.example.yml</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must have both files even if you are not using Scylla Manager</p>
</div>
<p>Add the labels for the cluster and data-center</p>
<p><code class="docutils literal notranslate"><span class="pre">scylla_servers.yml</span></code>:</p>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>scylla_servers.yml
<span class="c1"># List Scylla end points</span>

-<span class="w"> </span>targets:
<span class="w">  </span>-<span class="w"> </span><span class="m">192</span>.168.66.6
<span class="w">  </span>-<span class="w"> </span><span class="m">192</span>.168.66.244
<span class="w">  </span>labels:
<span class="w">    </span>cluster:<span class="w"> </span>cluster1
<span class="w">    </span>dc:<span class="w"> </span>dc1
-<span class="w"> </span>targets:
<span class="w">    </span>-<span class="w"> </span><span class="m">172</span>.17.0.3
<span class="w">  </span>labels:
<span class="w">    </span>cluster:<span class="w"> </span>cluster1
<span class="w">    </span>dc:<span class="w"> </span>dc2
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the previous note about deprecating the <code class="docutils literal notranslate"><span class="pre">node_exporter_servers.yml</span></code> file.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">scylla_manager_server.yml</span></code></p>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>-<span class="w"> </span>targets:
<span class="w">  </span>-<span class="w"> </span><span class="m">127</span>.0.0.1:5090
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Start Prometheus server:</p></li>
</ol>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>scylla-monitoring-scylla-monitoring-4.4.5/
./prometheus<span class="w"> </span>--config.file<span class="o">=</span>/etc/prometheus/prometheus.yml<span class="w"> </span>--storage.tsdb.path<span class="w"> </span>/prometheus/data
</pre></div>
</div>
<p>Data should start accumulate on: /prometheus/data</p>
<ol class="arabic simple" start="7">
<li><p>Verify that Prometheus is up and running, point your browser to the Prometheus IP:Port</p></li>
</ol>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>http://192.168.135.166:9090/
</pre></div>
</div>
<img alt="../_images/1.png" src="../_images/1.png" />
<p>Prometheus console should be visible</p>
<ol class="arabic simple" start="8">
<li><p>Verify that the node_exporter and scylla metrics accumulating in the server by executing a query through the console</p></li>
</ol>
<p>For example:</p>
<p><code class="docutils literal notranslate"><span class="pre">node_memory_MemFree</span></code></p>
<img alt="../_images/2.png" src="../_images/2.png" />
<p>And</p>
<p><code class="docutils literal notranslate"><span class="pre">scylla_reactor_utilization</span></code></p>
<img alt="../_images/3.png" src="../_images/3.png" />
<p>At this point Scylla is emitting the metrics and Prometheus is able to store them.</p>
</section>
<section id="install-grafana">
<h2>Install Grafana<a class="headerlink" href="#install-grafana" title="Link to this heading">¶</a></h2>
<p>Tested with Grafna 7.5.7</p>
<ol class="arabic simple">
<li><p>Install Grafana based on the instructions <a class="reference external" href="http://docs.grafana.org/installation/">here</a></p></li>
</ol>
<p>Depends if you installed Grafana from a repository (yum install), or if you downloaded the zip version, the directory structure will be
different in the rest of the steps.</p>
<ol class="arabic simple" start="2">
<li><p>Access Scylla-Grafana-monitoring directory</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>scylla-monitoring-scylla-monitoring-4.4.5/
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Copy the plugins to the grafana plugins directory (by default <code class="docutils literal notranslate"><span class="pre">/var/lib/grafana/</span></code>)</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>grafana/plugins<span class="w"> </span>/var/lib/grafana/
</pre></div>
</div>
<p>If you installed Grafana from packages, instead of <code class="docutils literal notranslate"><span class="pre">/var/lib/grafana/</span></code> you should copy it to <code class="docutils literal notranslate"><span class="pre">public/app</span></code> inside the directory you
opened Grafana in.</p>
<p>For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-r<span class="w"> </span>grafana/plugins<span class="w"> </span>../grafana-7.5.7/public/app
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Provision the Dashboards</p></li>
</ol>
<p>For example Scylla Open-source version 4.5 and Scylla manager version 2.4</p>
<p>For Grafana installed with <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">install</span></code></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cp<span class="w"> </span>grafana/load.yaml<span class="w"> </span>/etc/grafana/provisioning/dashboards/
sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/lib/grafana/dashboards
sudo<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>grafana/build/*<span class="w"> </span>/var/lib/grafana/dashboards
</pre></div>
</div>
<p>For Grafana installed from packages</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-p<span class="w"> </span>-r<span class="w"> </span>grafana/build/*<span class="w"> </span>../grafana-7.5.7/public/build/
cp<span class="w"> </span>-p<span class="w"> </span>grafana/load.yaml<span class="w"> </span>../grafana-7.5.7/conf/provisioning/dashboards/load.4.5.yaml
cp<span class="w"> </span>-p<span class="w"> </span>grafana/load.yaml<span class="w"> </span>../grafana-7.5.7/conf/provisioning/dashboards/load.manager_2.4.yaml
</pre></div>
</div>
<p>Edit the <code class="docutils literal notranslate"><span class="pre">load.*</span></code>  files in <code class="docutils literal notranslate"><span class="pre">/home/centos/grafana-7.5.7/conf/provisioning/dashboards/</span></code> for the correct path,
for example <code class="docutils literal notranslate"><span class="pre">load.4.5.yaml</span></code> would point to: <code class="docutils literal notranslate"><span class="pre">/home/centos/grafana-7.5.7/public/build/ver_4.5</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A note about using folders, if you provision multiple Scylla versions, use the version as a folder name. Otherwise, no need to configure a FOLDER.</p>
</div>
<ol class="arabic simple" start="5">
<li><p>Set the data source by copy <code class="docutils literal notranslate"><span class="pre">datasource.yml</span></code> and edit it</p></li>
</ol>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cp<span class="w"> </span>grafana/datasource.yml<span class="w"> </span>/etc/grafana/provisioning/datasources/
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scylla uses a plugin to read from some system tables see the section below about using it.</p>
</div>
<p>For Grafana installed from packages</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>-p<span class="w"> </span>grafana/datasource.yml<span class="w"> </span>/home/centos/grafana-7.5.7/conf/provisioning/datasources/
</pre></div>
</div>
<p>You should set the Prometheus and the alertmanager IP and port.</p>
<p>For example</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>cat<span class="w"> </span>/etc/grafana/provisioning/datasources/datasource.yml
apiVersion:<span class="w"> </span><span class="m">1</span>
datasources:
<span class="w"> </span>-<span class="w"> </span>name:<span class="w"> </span>prometheus
<span class="w">   </span>type:<span class="w"> </span>prometheus
<span class="w">   </span>url:<span class="w"> </span>http://192.168.135.167:9090
<span class="w">   </span>access:<span class="w"> </span>proxy
<span class="w">   </span>basicAuth:<span class="w"> </span><span class="nb">false</span>

<span class="w"> </span>-<span class="w"> </span>name:<span class="w"> </span>alertmanager
<span class="w">   </span>type:<span class="w"> </span>camptocamp-prometheus-alertmanager-datasource
<span class="w">   </span>orgId:<span class="w"> </span><span class="m">1</span>
<span class="w">   </span>typeLogoUrl:<span class="w"> </span>public/img/icn-datasource.svg
<span class="w">   </span>access:<span class="w"> </span>proxy
<span class="w">   </span>url:<span class="w"> </span>http://192.168.135.166:9093
<span class="w">   </span>password:
<span class="w">   </span>user:
<span class="w">   </span>database:
<span class="w">   </span>basicAuth:
<span class="w">   </span>isDefault:
<span class="w">   </span>jsonData:
<span class="w">     </span>severity_critical:<span class="w"> </span><span class="s1">&#39;4&#39;</span>
<span class="w">     </span>severity_high:<span class="w"> </span><span class="s1">&#39;3&#39;</span>
<span class="w">     </span>severity_warning:<span class="w"> </span><span class="s1">&#39;2&#39;</span>
<span class="w">     </span>severity_info:<span class="w"> </span><span class="s1">&#39;1&#39;</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p>Start the Grafana service</p></li>
</ol>
<p>For Grafana installed with <cite>yum install</cite></p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">service</span> <span class="pre">grafana-server</span> <span class="pre">start</span></code></p>
<p>For Grafana installed from packages:</p>
<p><code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">-p</span> <span class="pre">/home/centos/grafana-7.5.7/conf/sample.ini</span> <span class="pre">/home/centos/grafana-7.5.7/conf/scylla.ini</span></code></p>
<p>Edit scylla.ini to reflect the right paths in the paths section of the file.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">plugins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/centos/grafana-7.5.7/data/plugins
<span class="nv">provisioning</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/centos/grafana-7.5.7/conf/provisioning
</pre></div>
</div>
<p>Start the server:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>/home/centos/grafana-7.5.7/
./bin/grafana-server<span class="w"> </span>-config<span class="w"> </span>/home/centos/grafana-7.5.7/conf/scylla.ini
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li><p>Make sure Grafana is running</p></li>
</ol>
<p>Point your browser to the Grafana server port 3000, the assumption is that Grafana and Prometheus are collocated on the same server.</p>
<img alt="../_images/grafana.png" src="../_images/grafana.png" />
</section>
<section id="using-scylla-plugin-with-grafana">
<h2>Using Scylla Plugin with Grafana<a class="headerlink" href="#using-scylla-plugin-with-grafana" title="Link to this heading">¶</a></h2>
<p>Scylla Monitoring uses a plugin to read from some of the System tables. For the plugin to work it needs to be installed, configured and there should be a CQL connectivity between the Scylla Monitoring and the Scylla servers.</p>
<p>Because the plugin gives access to the Scylla tables, we strongly encourage you to add a user with read-only access restricted to the system keyspace and configure the plugin to use that user.</p>
<section id="setting-a-monitoring-user">
<h3>Setting a monitoring user<a class="headerlink" href="#setting-a-monitoring-user" title="Link to this heading">¶</a></h3>
<p>This part is optional, but is highly recommended. The instruction at <a class="reference external" href="https://docs.scylladb.com/operating-scylla/security/enable-authorization/">enable authorization</a> covers all the following items in details.</p>
<ul class="simple">
<li><p>If you have not done so, <a class="reference external" href="https://docs.scylladb.com/operating-scylla/security/enable-authorization/">enable authorization</a> first.</p></li>
<li><p>Add a new ROLL for the scylla monitoring: <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">ROLE</span> <span class="pre">scylla_monitoring</span> <span class="pre">WITH</span> <span class="pre">PASSWORD</span> <span class="pre">=</span> <span class="pre">'scylla_monitoring'</span> <span class="pre">AND</span> <span class="pre">LOGIN</span> <span class="pre">=</span> <span class="pre">true;</span></code> make sure to give it a proper password.</p></li>
<li><p>Add SELECT permissions to the new user: <code class="docutils literal notranslate"><span class="pre">GRANT</span> <span class="pre">SELECT</span> <span class="pre">on</span> <span class="pre">KEYSPACE</span> <span class="pre">system</span> <span class="pre">TO</span> <span class="pre">scylla_monitoring</span></code>;</p></li>
</ul>
</section>
<section id="installing-the-plugin">
<h3>Installing the Plugin<a class="headerlink" href="#installing-the-plugin" title="Link to this heading">¶</a></h3>
<p>Grafana reads plugins from its plugin directory, copy Scylla Plugin from  ‘grafana/plugins/scylla-datasource’ as described in the Grafana installation section.</p>
</section>
<section id="configure-the-plugin">
<h3>Configure the Plugin<a class="headerlink" href="#configure-the-plugin" title="Link to this heading">¶</a></h3>
<p>Add an entry to the datasource.yml file</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>-<span class="w"> </span>name:<span class="w"> </span>scylla-datasource
<span class="w">  </span>type:<span class="w"> </span>scylladb-scylla-datasource
<span class="w">  </span>orgId:<span class="w"> </span><span class="m">1</span>
<span class="w">  </span>isDefault:
<span class="w">  </span>jsonData:
<span class="w">  </span>host:<span class="w"> </span><span class="s1">&#39;&#39;</span>
<span class="c1">#  secureJsonData:</span>
<span class="c1">#    user: &#39;scylla_monitoring&#39;</span>
<span class="c1">#    password: &#39;scylla_monitoring&#39;</span>
</pre></div>
</div>
<p>As mentioned previously it is safer to use a dedicated user/password for the monitoring with limited access privileges. Un-comment the relevant section if you do so, note that the username/password are only visible in the file.</p>
</section>
<section id="enable-the-plugin">
<h3>Enable the Plugin<a class="headerlink" href="#enable-the-plugin" title="Link to this heading">¶</a></h3>
<p>Grafana will not load unsigned plugins, for that you will need to enable it with Grafana. Edit Grafana <code class="docutils literal notranslate"><span class="pre">grafana.ini</span></code> file and add
the line <code class="docutils literal notranslate"><span class="pre">allow_loading_unsigned_plugins:</span> <span class="pre">scylladb-scylla-datasource</span></code>.</p>
<p>See more about it the <a class="reference external" href="https://grafana.com/docs/grafana/latest/administration/configuration/#allow_loading_unsigned_plugins">Grafana configurtion</a>.</p>
</section>
</section>
</section>

                </div>
                
                    <div class="post-content">
                        
    <div class="feedback-container">
        <p class="feedback-container__title">Was this page helpful?</p>
        <span data-tooltip tabindex="1" title="Yes" data-position="top">
            <button class="feedback-container__button" id="feedback-positive">
                <i class="feedback-container__icon icon-docs-thumbs-up"></i>
            </button>
        </span>
        <span data-tooltip tabindex="1" title="No" data-position="top">
            <button class="feedback-container__button" id="feedback-negative">
                <i class="feedback-container__icon icon-docs-thumbs-down"></i>
            </button>
        </span>
        <div class="feedback-container__message" id="feedback-message"></div>
    </div>

    <script>
        function resetFeedbackButtonActive() {
            const feedbackButtons = document.getElementsByClassName('feedback-container__button');
            for (let i = 0; i < feedbackButtons.length; i++) {
                feedbackButtons[i].classList.remove('active');
            }
        }

        function showMessage(liked) {
            const feedbackMessage = document.getElementById('feedback-message');
            const themeGithubRepository = true;
            let message = 'Great! Thanks for your feedback.';
            if (themeGithubRepository && !liked) {
                message = "Thanks for your feedback! Please don't hesitate to <a href='https://github.com/scylladb/scylla-monitoring/issues/new?title=docs:%20Issue on page Deploying Scylla Monitoring Stack Without Docker&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://monitoring.docs.scylladb.com/branch-4.4/install/monitor-without-docker%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation'>create an issue</a> if you have any suggestions on how we can improve.";
            }
            feedbackMessage.innerHTML = message;
        }

        function sendGaEvent(liked) {
            const event_label = liked ? "positive" : "negative";
            const event = "feedback_" + event_label;
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': event,
            });
        }

        const positiveFeebackButton = document.getElementById('feedback-positive');
        const negativeFeedbackButton = document.getElementById('feedback-negative');

        positiveFeebackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(true);
            showMessage(true);
            positiveFeebackButton.classList.add('active');
        });

        negativeFeedbackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(false);
            showMessage(false);
            negativeFeedbackButton.classList.add('active');
        });
    </script>

                        <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="start-all.html">
                <button class="navigation__button">
                    <i class="icon-chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />The start-all.sh Command
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="docker-compose.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Using Docker Compose
                </div>
                <button class="navigation__button">
                    <i class="icon-chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                        <!-- Post content text -->
                    </div>
                

                
                    </div>
                    <div class="sidebar-right large-order-3">
                        <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a class="button button-sm" href="https://github.com/scylladb/scylla-monitoring/issues/new?title=docs:%20Issue on page Deploying Scylla Monitoring Stack Without Docker&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://monitoring.docs.scylladb.com/branch-4.4/install/monitor-without-docker%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
               target="_blank">
                <i class="icon-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a class="button button-sm" href="https://github.com/scylladb/scylla-monitoring/edit/master/docs/source/install/monitor-without-docker.rst"
                   target="_blank">
                    <i class="icon-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Deploying Scylla Monitoring Stack Without Docker</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#minimal-production-system-recommendations">Minimal Production System Recommendations</a><ul>
<li><a class="reference internal" href="#calculating-prometheus-minimal-disk-space-requirement">Calculating Prometheus Minimal Disk Space requirement</a></li>
<li><a class="reference internal" href="#calculating-prometheus-minimal-memory-space-requirement">Calculating Prometheus Minimal Memory Space requirement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-scylla-monitoring-stack">Install Scylla Monitoring Stack</a></li>
<li><a class="reference internal" href="#install-alertmanager">Install Alertmanager</a></li>
<li><a class="reference internal" href="#install-grafana-loki">Install Grafana Loki</a></li>
<li><a class="reference internal" href="#install-prometheus">Install Prometheus</a></li>
<li><a class="reference internal" href="#install-grafana">Install Grafana</a></li>
<li><a class="reference internal" href="#using-scylla-plugin-with-grafana">Using Scylla Plugin with Grafana</a><ul>
<li><a class="reference internal" href="#setting-a-monitoring-user">Setting a monitoring user</a></li>
<li><a class="reference internal" href="#installing-the-plugin">Installing the Plugin</a></li>
<li><a class="reference internal" href="#configure-the-plugin">Configure the Plugin</a></li>
<li><a class="reference internal" href="#enable-the-plugin">Enable the Plugin</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
    
</div>
                    </div>
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="icon-docs-menu-collapse"></i>
    </button>
    <div class="side-nav-content custom-scroll-bar">
        <div class="side-nav__title">
            <a href="../index.html">ScyllaDB Monitoring</a>
        </div>
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                4.4
            
            <i class="chevron icon-docs-chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
            
                
                    <li>
                        <a href="../../branch-4.14/install/monitor-without-docker.html">4.14</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../stable/install/monitor-without-docker.html">4.13</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.12/install/monitor-without-docker.html">4.12</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.11/install/monitor-without-docker.html">4.11</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.10/install/monitor-without-docker.html">4.10</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.9/install/monitor-without-docker.html">4.9</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.8/install/monitor-without-docker.html">4.8</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.7/install/monitor-without-docker.html">4.7</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.6/install/monitor-without-docker.html">4.6</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.5/install/monitor-without-docker.html">4.5</a>
                    </li>
                
            
                
                    <li>
                        <a href="monitor-without-docker.html">4.4</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.3/index.html">4.3</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.2/index.html">4.2</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.1/index.html">4.1</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.0/index.html">4.0</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.10/index.html">3.10</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.9/index.html">3.9</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.8/index.html">3.8</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.7/index.html">3.7</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.6/index.html">3.6</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.5/index.html">3.5</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Download and Install</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="monitoring-stack.html">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="start-all.html">The start-all.sh script</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Deploy without Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="docker-compose.html">Docker Compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="min-prod-hw.html">System Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="thanos.html">Using Thanos</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../use-monitoring/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../use-monitoring/cql-optimization.html">CQL Optimization Dashboard</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../use-monitoring/advisor/index.html">Advisor</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlAllowFiltering.html">Some queries use ALLOW FILTERING</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlCLAll.html">Some queries use Consistency Level: ALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlCLAny.html">Some queries use Consistency Level: ANY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNoTokenAware.html">Some queries are not token-aware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNonPaged.html">Some SELECT queries are non-paged</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNonPrepared.html">Some queries are non-prepared</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlReverseOrder.html">Some queries use reverse order</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/heavyCompaction.html">Compaction takes lots of memory and CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeCLErrors.html">Some operation failed due to unsatisfied consistency level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeIOErrors.html">I/O Errors can indicate a node with a faulty disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeLocalErrors.html">Some operations failed on the replica side</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nonBalancedcqlTraffic.html">CQL queries are not balanced among shards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/preparedCacheEviction.html">Prepared statements cache eviction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/systemOverload.html">System Overload</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../procedures/index.html">Procedures</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../procedures/datadog/index.html">Datadog Integration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../procedures/alerts/index.html">Alert Manager</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../procedures/alerts/alerting.html">Alerting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../procedures/updating-dashboard.html">Adding and Modifying Dashboards</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../upgrade/index.html">Upgrade Guides</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-4.x-to-monitoring-4.y.html">Monitoring 4.x to 4.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-3.x-to-monitoring-4.y.html">Monitoring 3.x to 4.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-3.x-to-monitoring-3.y.html">Monitoring 3.x to 3.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-2.x-to-monitoring-3.y.html">Monitoring 2.x to 3.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-2.x-to-monitoring-2.y.html">Monitoring 2.x to 2.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">Monitoring 1.x to 2.x</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../upgrade/index.html">Upgrade</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-4.x-to-monitoring-4.y.html">Monitoring 4.x to 4.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-3.x-to-monitoring-4.y.html">Monitoring 3.x to 4.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-3.x-to-monitoring-3.y.html">Monitoring 3.x to 3.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-2.x-to-monitoring-3.y.html">Monitoring 2.x to 3.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-2.x-to-monitoring-2.y.html">Monitoring 2.x to 2.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="../upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">Monitoring 1.x to 2.x</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/monitor-troubleshoot.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.scylladb.com/troubleshooting/manager_monitoring_integration/">Troubleshooting Guide for Scylla Manager and Scylla Monitor Integration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/matrix.html">Support Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/monitoring-apis.html">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/scylladb/scylla-monitoring/">GitHub Project</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>

        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com"></a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/" target="_blank">Docs</a>
                <a class="footer-links__link" href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html" target="_blank">Tutorials</a>
                <a class="footer-links__link" href="https://university.scylladb.com/" target="_blank">University</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/"
                   target="_blank">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/" target="_blank">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <i class="icon-slack"></i>
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <i class="icon-docs-community"></i>
                    </span>
                </a>
            </div>
        </div>

        
            <div class="footer-copyright">
                
                    
                        &#169; 2026, ScyllaDB. All rights reserved.
                    
                    | <a class="footer-copyright__link" href="https://www.scylladb.com/tos/" target="_blank">Terms of Service</a>
                    | <a class="footer-copyright__link" href="https://www.scylladb.com/privacy/" target="_blank">Privacy Policy</a>
                    | ScyllaDB, and ScyllaDB Cloud, are registered trademarks of ScyllaDB, Inc.
                
            </div>
        


        <div class="footer-bottom">
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 22 February 2026.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a class="footer-bottom__link" href="http://sphinx-doc.org/">Sphinx 7.4.7</a> &amp;
                <a class="footer-bottom__link" href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.8.10</a>
            </div>
        </div>
    </div>
    
        <biel-button class="footer-ask-ai" project="ddfdo8m94k"
                     header-title="ScyllaDB chatbot (beta)"
                     button-position="bottom-right"
                     modal-position="bottom-right"
                     button-style="dark">
            Ask AI
        </biel-button>
    
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                    style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>
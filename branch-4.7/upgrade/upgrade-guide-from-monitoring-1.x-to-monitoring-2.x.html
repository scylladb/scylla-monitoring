

<!DOCTYPE html>
<html class="no-js" lang="en" style="visibility: hidden;">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x | ScyllaDB Docs 
        </title>
        <meta name="description" content="Scylla Monitoring Stack is a full stack for Scylla monitoring and alerting. The stack contains open source tools including Prometheus and Grafana, as well as custom Scylla dashboards and tooling." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://monitoring.docs.scylladb.com/stable/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                  href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>

        
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.css">
            <script type="module" src="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.esm.js"></script>
        

        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css?v=0ebb4bd5" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
            
        
    
        
        
            
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script src="../_static/documentation_options.js?v=5929fcd5"></script>
            
        
            
                <script src="../_static/doctools.js?v=9a2dae69"></script>
            
        
            
                <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
            
        
            
                <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
            
        
            
                <script src="../_static/copybutton.js?v=f281be69"></script>
            
        
    
            
                <!-- Local meta tags -->
            
            
                <!-- Google Tag Manager docs -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-54NWVS4");
</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager global -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
            
        
    </head>

    <body class="brand-product">
        <section class="promo-banner  promo-banner--hide" style="display: none;">
    <div class="promo-banner-wrapper">
        <div class="promo-banner__content">
            
            <div class="promo-banner__title">ScyllaDB University Live | Free Virtual Training Event</div>
            <a class="promo-banner__button button button--reverse" href="#"
               target="_blank" rel="noopener noreferrer">Learn more</a>
        </div>
        <button class="promo-banner__close">
            <i class="icon-cancel"></i>
        </button>
    </div>
</section>
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/scylladb-logo-horizontal.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Deployments <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="icon-docs-cloud"></i>Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/manual/">
                            <i class="icon-server"></i>Server</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="icon-docs-manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="icon-docs-monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="icon-docs-operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/stable/drivers/cql-drivers">
                            <i class="icon-docs-nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/stable/drivers/dynamo-drivers">
                            <i class="icon-docs-alternator"></i>DynamoDB Drivers
                        </a>

                        <li>
                            <a href="https://docs.scylladb.com/stable/versioning/driver-support">
                                <i class="icon-docs-blog"></i>Supported Driver Versions
                            </a>
                        </li>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Resources
                    <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://university.scylladb.com">
                            <i class="icon-university"></i>
                            ScyllaDB University
                        </a>
                    </li>
                    <li>
                        <a href="https://forum.scylladb.com">
                            <i class="icon-docs-community"></i>
                            Community Forum
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html">
                            <i class="icon-docs-training"></i>
                            Tutorials
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://docs.scylladb.com/manual/stable/getting-started/installation-common/scylla-web-installer.html" class="button"><i class="icon-download me-2"></i> Install</a>
        </div>
    </div>
    <div class="header-search-box">
        <i class="dark-theme-toggler icon-theme"></i>
        <div class="search-box">
            <ci-search></ci-search>
        </div>
        
            <biel-button class="header-ask-ai" project="ddfdo8m94k"
                         header-title="ScyllaDB chatbot (beta)"
                         button-position="default"
                         modal-position="bottom-right"
                         button-style="dark">
                Ask AI
            </biel-button>
        
    </div>
    <div class="side-nav-toggle">
    <i class="dark-theme-toggler icon-theme"></i>
    <div class="side-nav-toggle__button" data-toggle="side-nav">
        <i class="icon-menu"></i>
    </div>
</div>
</header>
        <div class="title"></div>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
           class="bread__highlight">
            <i class="icon-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="../index.html"
           class="bread__highlight">
            ScyllaDB Monitoring
        </a>
    </span>
    
        <span class="bread__item">
            <a href="../procedures/index.html" class="bread__highlight">
                ScyllaDB Monitoring Stack Procedures
            </a>
        </span>
    
        <span class="bread__item">
            <a href="index.html" class="bread__highlight">
                Upgrade Scylla Monitoring Stack
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x</span>
</div>
                    </div>
                
                
                    <div class="sidebar-right-layout">
                        <div class="body-container">
                

                <div class="content-body">
                    
                        
    <div class="admonition caution">
        <p class="admonition-title">Caution</p>
        <p>
            
                You're viewing documentation for a previous version of ScyllaDB Monitoring.
            
            <a href="../../stable/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">Switch to the latest stable version.</a>
        </p>
    </div>

                    

                    <section id="upgrade-guide-scylla-monitoring-1-x-to-scylla-monitoring-2-x">
<h1>Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x<a class="headerlink" href="#upgrade-guide-scylla-monitoring-1-x-to-scylla-monitoring-2-x" title="Link to this heading">¶</a></h1>
<p>This document is a step by step procedure for upgrading ScyllaDB Monitoring Stack from version 1.x to 2.x</p>
<p>Scylla monitoring stack uses <a class="reference external" href="https://prometheus.io">Prometheus</a> as its metrics database. The main differences between Scylla Monitoring 1.x and 2.x are moving from Prometheus version 1.x to Prometheus 2.x.
Since Prometheus is not backward compatible between these two versions, the upgrade procedure consists of running the two monitoring stack, old and new, in <strong>parallel</strong>, allowing the new stack to read metrics from the old one. This procedure will enable you to migrate your Scylla monitoring stack without losing historical metric data in the process.
Once the Prometheus retention time has passed, you can safely remove the old stack.</p>
<section id="upgrade-procedure">
<h2>Upgrade Procedure<a class="headerlink" href="#upgrade-procedure" title="Link to this heading">¶</a></h2>
<section id="upgrade-to-the-latest-1-x-version">
<h3>1. Upgrade to the latest 1.x version<a class="headerlink" href="#upgrade-to-the-latest-1-x-version" title="Link to this heading">¶</a></h3>
<p>Before starting the upgrade procedure, make sure you are running the <a class="reference external" href="https://github.com/scylladb/scylla-monitoring/releases/">latest 1.x version</a></p>
</section>
<section id="install-the-new-monitoring-stack">
<h3>2. Install the new monitoring stack<a class="headerlink" href="#install-the-new-monitoring-stack" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Download the 2.x version from the <a class="reference external" href="https://github.com/scylladb/scylla-monitoring/releases">release</a> page.</p></li>
<li><p>Unzip it into a <strong>different</strong> directory. This is important, as Prometheus is not backward compatible and would not be able to use the old data.</p></li>
<li><p>You can use the server definitions from the old monitoring stack by copying the target files from the old stack to the new one, located on the <code class="docutils literal notranslate"><span class="pre">prometheus/</span></code> directory:</p>
<ul class="simple">
<li><p>scylla_servers.yml</p></li>
<li><p>scylla_manager_servers.yml</p></li>
<li><p>node_exporter_servers.yml</p></li>
</ul>
</li>
<li><p>Start the new monitoring stack. If you are using Docker, make sure you are using <code class="docutils literal notranslate"><span class="pre">-g</span></code> <code class="docutils literal notranslate"><span class="pre">-p</span></code> and <code class="docutils literal notranslate"><span class="pre">-m</span></code> to specify different ports than the old monitoring stack. For example:</p></li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./start-all.sh<span class="w"> </span>-g<span class="w"> </span><span class="m">3001</span><span class="w"> </span>-p<span class="w"> </span><span class="m">9091</span><span class="w"> </span>-m<span class="w"> </span><span class="m">9094</span><span class="w"> </span>-d<span class="w"> </span>/new-prometheus-data-path
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to use the <code class="docutils literal notranslate"><span class="pre">-d</span></code> option, letting Prometheus keep its data <strong>outside</strong> the Docker container. Fail to do so will result in loss of historical data in case you restart the monitoring stack.</p>
</div>
<p>While the <strong>old</strong> monitoring stack keeps working, you can take the <strong>new</strong> stack up and down to make sure everything works correctly. Note that if you are using non-default ports setting, you should use the same for stopping the stack:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./kill-all.sh<span class="w"> </span>-g<span class="w"> </span><span class="m">3001</span><span class="w"> </span>-p<span class="w"> </span><span class="m">9091</span><span class="w"> </span>-m<span class="w"> </span><span class="m">9094</span>
</pre></div>
</div>
<section id="validation">
<h4>Validation<a class="headerlink" href="#validation" title="Link to this heading">¶</a></h4>
<p>Make sure the new monitoring stack is working before moving to 2.x as your main system. See that the graphs return data, and nodes are reachable.</p>
</section>
</section>
<section id="alerting-rules">
<h3>3. Alerting Rules<a class="headerlink" href="#alerting-rules" title="Link to this heading">¶</a></h3>
<p>Note that alerting rules moved to a yml file format. Make sure that all defined rules are taken.</p>
</section>
<section id="moving-to-prometheus-2-x">
<h3>4. Moving to Prometheus 2.x<a class="headerlink" href="#moving-to-prometheus-2-x" title="Link to this heading">¶</a></h3>
<p>Monitoring stack Version 2.0 upgrade the Prometheus version from 1.8 to 2.3. This upgrade is not backward compatible.
Prometheus Migration is cover <a class="reference external" href="https://Prometheus.io/docs/Prometheus/latest/migration/">here</a>.
Note that when using the docker containers, besides the data migration, the docker permissions were changed. This means that the permissions of the data directory will no longer work.</p>
<p>Do the following to allow the Prometheus in the new monitoring stack to read historical metrics from the old Prometheus:</p>
<section id="a-set-the-old-system">
<h4>a. Set the old system<a class="headerlink" href="#a-set-the-old-system" title="Link to this heading">¶</a></h4>
<p>The following steps will stop the <strong>old</strong> monitoring stack from reading new metrics while exposing an API for the <strong>new</strong> monitoring stack to read historical metrics from.</p>
<ul class="simple">
<li><p>In the <strong>old</strong> Prometheus <cite>prometheus.yml.template</cite> file, remove the <code class="docutils literal notranslate"><span class="pre">alerting</span></code>, <code class="docutils literal notranslate"><span class="pre">scrape_configs</span></code>, and <code class="docutils literal notranslate"><span class="pre">rule_files</span></code> sections, keeping only the <code class="docutils literal notranslate"><span class="pre">external_labels</span></code> section.</p></li>
<li><p>Restart the <strong>old</strong> monitoring stack with, <code class="docutils literal notranslate"><span class="pre">kill-all.sh</span></code> followed by <code class="docutils literal notranslate"><span class="pre">start-all.sh</span></code> with command line flag <code class="docutils literal notranslate"><span class="pre">-b</span> <span class="pre">&quot;-web.listen-address=:9111&quot;</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After this phase, the <strong>old</strong> monitoring stack will not be updated with new metrics. It will only serve as a data source of historical data for the <strong>new</strong> stack</p>
</div>
</section>
<section id="b-set-the-new-system">
<h4>b. Set the new system<a class="headerlink" href="#b-set-the-new-system" title="Link to this heading">¶</a></h4>
<p>The following step will allow the <strong>new</strong> monitoring system to read historical metrics from the old system.</p>
<ul class="simple">
<li><p>In the Prometheus <cite>prometheus.yml.template</cite> file add the following at the end:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>remote_read:
<span class="w">  </span>-<span class="w"> </span>url:<span class="w"> </span><span class="s2">&quot;http://{ip}:9111/api/v1/read&quot;</span>
</pre></div>
</div>
<p>Where {ip} is the ip of the old system.</p>
<ul class="simple">
<li><p>restart the <strong>new</strong> stack</p></li>
</ul>
</section>
</section>
<section id="validate-the-upgrade">
<h3>Validate the upgrade<a class="headerlink" href="#validate-the-upgrade" title="Link to this heading">¶</a></h3>
<p>You should be able to see the graphs on the new stack. Make sure you see the graphs’ history.
By default, the Prometheus retention period is 15 days, so after that period, it is safe to take down the old system and remove the <cite>remote_read</cite> from the new Prometheus configuration.</p>
</section>
</section>
<section id="rollback">
<h2>Rollback<a class="headerlink" href="#rollback" title="Link to this heading">¶</a></h2>
<p>In the upgrade procedure, you set up a second monitoring stack. The old monitoring stack continues to work in parallel. To rollback, add back the Prometheus targets in the old system, and take down the new system.</p>
</section>
<section id="related-links">
<h2>Related Links<a class="headerlink" href="#related-links" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="index.html"><span class="doc">Upgrade</span></a></p></li>
<li><p><a class="reference external" href="https://Prometheus.io/docs/Prometheus/latest/migration/">Prometheus Migration</a></p></li>
</ul>
</section>
</section>

                </div>
                
                    <div class="post-content">
                        
    <div class="feedback-container">
        <p class="feedback-container__title">Was this page helpful?</p>
        <span data-tooltip tabindex="1" title="Yes" data-position="top">
            <button class="feedback-container__button" id="feedback-positive">
                <i class="feedback-container__icon icon-docs-thumbs-up"></i>
            </button>
        </span>
        <span data-tooltip tabindex="1" title="No" data-position="top">
            <button class="feedback-container__button" id="feedback-negative">
                <i class="feedback-container__icon icon-docs-thumbs-down"></i>
            </button>
        </span>
        <div class="feedback-container__message" id="feedback-message"></div>
    </div>

    <script>
        function resetFeedbackButtonActive() {
            const feedbackButtons = document.getElementsByClassName('feedback-container__button');
            for (let i = 0; i < feedbackButtons.length; i++) {
                feedbackButtons[i].classList.remove('active');
            }
        }

        function showMessage(liked) {
            const feedbackMessage = document.getElementById('feedback-message');
            const themeGithubRepository = true;
            let message = 'Great! Thanks for your feedback.';
            if (themeGithubRepository && !liked) {
                message = "Thanks for your feedback! Please don't hesitate to <a href='https://github.com/scylladb/scylla-monitoring/issues/new?title=docs:%20Issue on page Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://monitoring.docs.scylladb.com/branch-4.7/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation'>create an issue</a> if you have any suggestions on how we can improve.";
            }
            feedbackMessage.innerHTML = message;
        }

        function sendGaEvent(liked) {
            const event_label = liked ? "positive" : "negative";
            const event = "feedback_" + event_label;
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': event,
            });
        }

        const positiveFeebackButton = document.getElementById('feedback-positive');
        const negativeFeedbackButton = document.getElementById('feedback-negative');

        positiveFeebackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(true);
            showMessage(true);
            positiveFeebackButton.classList.add('active');
        });

        negativeFeedbackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(false);
            showMessage(false);
            negativeFeedbackButton.classList.add('active');
        });
    </script>

                        <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="upgrade-guide-from-monitoring-2.x-to-monitoring-2.y.html">
                <button class="navigation__button">
                    <i class="icon-chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Upgrade Guide - Scylla Monitoring 2.x to Scylla Monitoring 2.y
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="../troubleshooting/index.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Troubleshooting Guide for Scylla Monitoring Stack
                </div>
                <button class="navigation__button">
                    <i class="icon-chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                        <!-- Post content text -->
                    </div>
                

                
                    </div>
                    <div class="sidebar-right large-order-3">
                        <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a class="button button-sm" href="https://github.com/scylladb/scylla-monitoring/issues/new?title=docs:%20Issue on page Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://monitoring.docs.scylladb.com/branch-4.7/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
               target="_blank">
                <i class="icon-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a class="button button-sm" href="https://github.com/scylladb/scylla-monitoring/edit/master/docs/source/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.rst"
                   target="_blank">
                    <i class="icon-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Upgrade Guide - Scylla Monitoring 1.x to Scylla Monitoring 2.x</a><ul>
<li><a class="reference internal" href="#upgrade-procedure">Upgrade Procedure</a><ul>
<li><a class="reference internal" href="#upgrade-to-the-latest-1-x-version">1. Upgrade to the latest 1.x version</a></li>
<li><a class="reference internal" href="#install-the-new-monitoring-stack">2. Install the new monitoring stack</a><ul>
<li><a class="reference internal" href="#validation">Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alerting-rules">3. Alerting Rules</a></li>
<li><a class="reference internal" href="#moving-to-prometheus-2-x">4. Moving to Prometheus 2.x</a><ul>
<li><a class="reference internal" href="#a-set-the-old-system">a. Set the old system</a></li>
<li><a class="reference internal" href="#b-set-the-new-system">b. Set the new system</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validate-the-upgrade">Validate the upgrade</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rollback">Rollback</a></li>
<li><a class="reference internal" href="#related-links">Related Links</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                    </div>
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="icon-docs-menu-collapse"></i>
    </button>
    <div class="side-nav-content custom-scroll-bar">
        <div class="side-nav__title">
            <a href="../index.html">ScyllaDB Monitoring</a>
        </div>
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                4.7
            
            <i class="chevron icon-docs-chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
            
                
                    <li>
                        <a href="../../branch-4.14/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.14</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../stable/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.13</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.12/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.12</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.11/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.11</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.10/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.10</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.9/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.9</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.8/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.8</a>
                    </li>
                
            
                
                    <li>
                        <a href="upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.7</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.6/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.6</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.5/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.5</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.4/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.4</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.3/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.3</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.2/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.2</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.1/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.1</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-4.0/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">4.0</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.10/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">3.10</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.9/upgrade/upgrade-guide-from-monitoring-1.x-to-monitoring-2.x.html">3.9</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.8/index.html">3.8</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.7/index.html">3.7</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.6/index.html">3.6</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-3.5/index.html">3.5</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../install/index.html">Download and Install</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../install/monitoring-stack.html">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/start-all.html">The start-all.sh script</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/monitor-without-docker.html">Deploy without Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/docker-compose.html">Docker Compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/min-prod-hw.html">System Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install/thanos.html">Using Thanos</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../use-monitoring/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../use-monitoring/cql-optimization.html">CQL Optimization Dashboard</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../use-monitoring/advisor/index.html">Advisor</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlAllowFiltering.html">Some queries use ALLOW FILTERING</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlCLAll.html">Some queries use Consistency Level: ALL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlCLAny.html">Some queries use Consistency Level: ANY</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNoTokenAware.html">Some queries are not token-aware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNonPaged.html">Some SELECT queries are non-paged</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/cqlNonPrepared.html">Some queries are non-prepared</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/heavyCompaction.html">Compaction takes lots of memory and CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeCLErrors.html">Some operation failed due to unsatisfied consistency level</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeIOErrors.html">I/O Errors can indicate a node with a faulty disk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nodeLocalErrors.html">Some operations failed on the replica side</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/nonBalancedcqlTraffic.html">CQL queries are not balanced among shards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/preparedCacheEviction.html">Prepared statements cache eviction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../use-monitoring/advisor/systemOverload.html">System Overload</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../procedures/index.html">Procedures</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../procedures/datadog/cloud-integration.html">Cloud Users Datadog integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../procedures/datadog/index.html">Datadog Integration</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../procedures/alerts/index.html">Alert Manager</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../procedures/alerts/alerting.html">Alerting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../procedures/updating-dashboard.html">Adding and Modifying Dashboards</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Upgrade Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="upgrade-guide-from-monitoring-4.x-to-monitoring-4.y.html">Monitoring 4.x to 4.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrade-guide-from-monitoring-3.x-to-monitoring-4.y.html">Monitoring 3.x to 4.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrade-guide-from-monitoring-3.x-to-monitoring-3.y.html">Monitoring 3.x to 3.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrade-guide-from-monitoring-2.x-to-monitoring-3.y.html">Monitoring 2.x to 3.y</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrade-guide-from-monitoring-2.x-to-monitoring-2.y.html">Monitoring 2.x to 2.y</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Monitoring 1.x to 2.x</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Upgrade</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="upgrade-guide-from-monitoring-4.x-to-monitoring-4.y.html">Monitoring 4.x to 4.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade-guide-from-monitoring-3.x-to-monitoring-4.y.html">Monitoring 3.x to 4.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade-guide-from-monitoring-3.x-to-monitoring-3.y.html">Monitoring 3.x to 3.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade-guide-from-monitoring-2.x-to-monitoring-3.y.html">Monitoring 2.x to 3.y</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrade-guide-from-monitoring-2.x-to-monitoring-2.y.html">Monitoring 2.x to 2.y</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Monitoring 1.x to 2.x</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/monitor-troubleshoot.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.scylladb.com/troubleshooting/manager_monitoring_integration/">Troubleshooting Guide for Scylla Manager and Scylla Monitor Integration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/matrix.html">Support Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/monitoring-apis.html">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/scylladb/scylla-monitoring/">GitHub Project</a></li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>

        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com"></a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/" target="_blank">Docs</a>
                <a class="footer-links__link" href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html" target="_blank">Tutorials</a>
                <a class="footer-links__link" href="https://university.scylladb.com/" target="_blank">University</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/"
                   target="_blank">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/" target="_blank">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <i class="icon-slack"></i>
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <i class="icon-docs-community"></i>
                    </span>
                </a>
            </div>
        </div>

        
            <div class="footer-copyright">
                
                    
                        &#169; 2026, ScyllaDB. All rights reserved.
                    
                    | <a class="footer-copyright__link" href="https://www.scylladb.com/tos/" target="_blank">Terms of Service</a>
                    | <a class="footer-copyright__link" href="https://www.scylladb.com/privacy/" target="_blank">Privacy Policy</a>
                    | ScyllaDB, and ScyllaDB Cloud, are registered trademarks of ScyllaDB, Inc.
                
            </div>
        


        <div class="footer-bottom">
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 22 February 2026.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a class="footer-bottom__link" href="http://sphinx-doc.org/">Sphinx 7.4.7</a> &amp;
                <a class="footer-bottom__link" href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.8.10</a>
            </div>
        </div>
    </div>
    
        <biel-button class="footer-ask-ai" project="ddfdo8m94k"
                     header-title="ScyllaDB chatbot (beta)"
                     button-position="bottom-right"
                     modal-position="bottom-right"
                     button-style="dark">
            Ask AI
        </biel-button>
    
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                    style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>